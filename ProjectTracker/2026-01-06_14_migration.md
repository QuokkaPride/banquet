# 2026-01-06_14_migration.md
# Step 14: Create Database Migration

## Metadata
- **Order**: 14 of 16
- **Estimated Time**: 5 minutes
- **Dependencies**: Step 13 (schema update)
- **Creates**: New migration file

## Purpose
Create SQL migration to add the `suitable_meal_times` column to existing database.

---

## Prompt for LLM

Create a new migration file at `prisma/migrations/20250825160057_add_meal_times/migration.sql`:
```sql
-- AlterTable: Add suitable_meal_times to recipes
ALTER TABLE "recipes" ADD COLUMN "suitable_meal_times" TEXT NOT NULL DEFAULT 'BREAKFAST,LUNCH,DINNER';
```

Then run these commands to apply:
```bash
# Stop any running containers
npm run db-down

# Start fresh
npm run db-up

# Wait for postgres to be ready (check with docker ps)
docker ps

# Generate Prisma client with new schema
npx prisma generate

# Push schema changes to database
npx prisma db push
```

---

## Validation Checklist
- [ ] Migration file created
- [ ] `npm run db-up` succeeds
- [ ] `npx prisma generate` succeeds
- [ ] `npx prisma db push` succeeds
- [ ] No errors in console